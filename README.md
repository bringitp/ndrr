# ndrr
   
チャットサイトを作ることを考える。
部屋をつくることができるサイトで、部屋の上限人数は２０人。使われなくなった部屋は廃棄される。部屋主は部屋名の変更、部屋の人数の変更、部屋にいる人を部屋から追い出す機能がある。

x なおユーザ認証はLINE認証かGoogleアカウントの認証OAuth 2.0を用いることとする。  
o OktaによるAuth2.0を利用する  
ログインしたユーザは自身の名前を変更する機能を持つ。

SMSは予算的に使わない

### 観念理論を設計理念とする。
自由度多様性の高さは精神成熟の証。最大限保障し問題の早期発見等に活用が吉。民度の低い集団ほど不都合な存在を嫌悪排除。  
雑言等は不遇な未熟者の自己投影・同属嫌悪。表現狩り等で自由奪えば却って暴発。必要なのは排除処罰ではなく治療教育。  

![image](https://github.com/bringitp/ndrr/assets/141851166/d936bcf7-b349-4cca-9c8b-30630bd8c9be)


### 開発
---
ChatGPTに全フリした開発手法で開発していく。要件定義書を毎回投げて新規チャットで細かく深堀した部分を聞いていく。  
ややTDDを意識した感じで。  
ConohaのVPS Ubuntu 2x系で動けばいいやという感  
おおよそ100人くらいが同時にチャットを応答速度3秒以内のレスポンスでできればよしとする 
  
#### Auth2.0
![スクリーンショット_2023-08-13_18-31-57](https://github.com/bringitp/ndrr/assets/141851166/e24fbed6-f9ad-4af7-ae5b-9cf5fe1b55f3)
#### YahooIDで開発すると俺だけがやられる仕組みであるらしい（却下）
![スクリーンショット_2023-08-13_21-14-51](https://github.com/bringitp/ndrr/assets/141851166/732ce20f-6ec2-44fe-9235-74dc696409e1)

#### Backend
MySQL
Python 3.10.12 SQLAlchemy
FastAPI
なんらかのWAF

#### Frontend
未定。多分React OAuth2.0に対応したフレームワークがあればそれを採用

#### DB SCHEME
https://github.com/bringitp/ndrr/blob/main/DB_SCHEME.md
#### FOLDER STRUCTURE
https://github.com/bringitp/ndrr/blob/main/FOLDER_STRUCTURE
#### 開発風景写真集
[開発風景](https://github.com/bringitp/ndrr/blob/main/%E9%96%8B%E7%99%BA%E9%A2%A8%E6%99%AF%E5%86%99%E7%9C%9F%E9%9B%86.md)
#### Oauth2.0発行の概念図のようなもの
![アクセスToken発行 Okta](https://github.com/bringitp/ndrr/assets/141851166/5162dd51-c596-494a-9789-b364501e2a38)
#### バックエンドの構成図のようなもの
![無題の図形描画 (2)](https://github.com/bringitp/ndrr/assets/141851166/753110cf-bc64-4839-925c-177588c8eccd)

---

## 要件定義書　これを毎回ChatGPTに投げながら細かい部分を深堀していく。とても大事。
---

## 0. ユーザ認証基盤 (15点)
- LINE認証かGoogleアカウントの認証OAuth 2.0を使う

## 1. ユーザ認証とアカウント管理 (30点)
- ユーザー登録とログイン機能
- ユーザー名の変更機能（月に５回まで程度の変更上限回数あり、ユーザ名に使えない文字列、全角アルファベットなどあり）
- ユーザーのアイコン変更機能
- トリップは必須
- 課金ユーザなどの特権ユーザであるかの状態保持
- 個別チャットに対する相手のNGリスト編集
- 退会処理

## 2. 固定部屋機能 (5点)
- 部屋主機能が不要

## 3. 部屋管理機能 (20点)
- 部屋の作成、編集、削除機能
- 部屋のリスト表示
- 部屋の上限人数制限 (最大20人)
- 部屋の状態 (アクティブ、非アクティブ) の管理
- 部屋の活動状態の管理と誰も居ない部屋の廃棄機能

## 4. 部屋内チャット機能 (30点)
- リアルタイムチャット機能の実装
- テキストメッセージの送受信
- メッセージの表示（概ね３０件を上限）
- 部屋内でのみ可能な1対1チャット
- 部屋内でのみ可能な1対1チャットの拒否リスト（ユーザ認証基盤での永続管理)
- 部屋チャットでの相手の無視機能
- 部屋チャットで画像投稿処理
- 30分以上無言であれば部屋チャットからの追い出し処理

## 5. 部屋主の機能 (15点)
- 部屋主の特権である部屋名変更機能の実装
- 部屋主の特権である部屋の人数変更機能の実装
- 部屋主の特権である部屋からのユーザーの追放機能の実装
- 部屋主の特権を他者に委任
- 部屋主は部屋のメッセージ一覧を消去することができる
  
## 5. 通知とアラート (10点)
- 新しいメッセージの通知
- 部屋への招待や変更に関する通知

## 6. セキュリティとプライバシー (15点)
- データ暗号化とセキュリティ対策
- セッション管理とトークンベースの認証

## 7. 拡張性とスケーラビリティ (5点)
- 定期バックアップ

## 9. UI/UX デザイン (15点)
- ユーザーフローの設計
- 部屋リスト、チャット画面のデザイン

## 10. モバイル対応 (5点)
- レスポンシブデザインの導入
- ✗モバイルアプリの開発 (必要であれば)

## 11. 法的およびコンプライアンス要件 (10点)
- ユーザーデータの保護と適切な処理

## 13. デプロイと運用 (5点)
- サーバーのセットアップとデプロイ
- ログとエラートラッキングの設定 SPAM行為を行った人物の一覧
- システムのモニタリングとスケーリング戦略
- SQLインジェクションの提案をGPTにやってもらいながら何ができるか確認をする

## 14. SPAM対策 (5点)
- SPAM判定ロジックの実装（レーベンシュタイン距離の短いものを短時間に連続投稿を行った場合/NGワードを含んでいた場合)
- SPAM行為を行うユーザに対する認証基盤での点数加点
- SPAM行為を行うユーザの部屋からの追放
- ユーザのメッセージに対して極性分析を行い、発言毎の極性分析値をメッセージリストは持つ

---
